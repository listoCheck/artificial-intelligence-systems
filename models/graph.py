import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
data_text = """
1 5618
2 1961
3 14481
4 3342
5 22151
6 10328
7 4595
8 7174
9 4759
10 12695
11 58107
12 2960
13 33031
14 8895
15 987
16 1418
17 50312
18 5900
19 326
20 737
21 1193
22 8225
23 2981
24 3436
25 127898
26 403
27 5624
28 1608
29 9920
30 51153
31 6378
32 31427
33 100896
34 79117
35 4996
36 3708
37 36101
38 9173
39 28048
40 44792
41 28593
42 3312
43 151845
44 99
45 13254
46 9102
47 8321
48 77
49 57862
50 1320
51 9767
52 57767
53 1568
54 11890
55 345
56 27693
57 27884
58 57038
59 44111
60 20487
61 7105
62 7243
63 5818
64 12941
65 938
66 5822
67 5240
68 1572
69 5497
70 1945
71 6883
72 187818
73 57
74 749
75 11384
76 2434
77 17949
78 2122
79 30287
80 6645
81 116435
82 9
83 1013
84 3305
85 244
86 903
87 2020
88 120055
89 8842
90 56420
91 3204
92 2344
93 3368
94 5317
95 1475
96 185605
97 4221
98 91320
99 6891
100 4681
101 598
102 2162
103 1331
104 49496
105 104099
106 91665
107 882
108 699
109 31608
110 37763
111 2775
112 489
113 5430
114 12623
115 42230
116 2391
117 815
118 411
119 3706
120 2825
121 5664
122 4030
123 11393
124 5488
125 131920
126 549
127 71074
128 1749
129 46418
130 1336
131 49501
132 1257
133 2983
134 4328
135 4566
136 88791
137 23209
138 5160
139 69156
140 2553
141 19068
142 3010
143 57382
144 122
145 11744
146 9043
147 1089
148 228
149 4243
150 840
151 972
152 729
153 7102
154 248871
155 24067
156 5135
157 1321
158 4486
159 121361
160 11582
161 1534
162 8059
163 9184
164 1017
165 42416
166 78655
167 10302
168 78644
169 387
170 1285
171 1616
172 9201
173 15339
174 1758
175 6240
176 13741
177 732
178 1969
179 60859
180 955
181 37326
182 66959
183 2155
184 7076
185 6379
186 55187
187 861
188 18879
189 2091
190 5426
191 4934
192 3289
193 27865
194 3314
195 2141
196 1234
197 4742
198 105354
199 11477
200 19408
201 660
202 16702
203 24923
204 57602
205 55996
206 35514
207 21858
208 2699
209 2014
210 6975
211 139
212 6110
213 30183
214 3768
215 2596
216 9718
217 10656
218 662
219 2273
220 189660
221 8468
222 20457
223 10167
224 4471
225 3845
226 11411
227 759
228 535
229 35600
230 5324
231 61695
232 51008
233 333
234 280
235 1572
236 10888
237 2551
238 113
239 4940
240 3806
241 2945
242 16782
243 1269
244 5153
245 1598
246 4254
247 5598
248 661
249 4162
250 95414
251 91767
252 1406
253 9485
254 4209
255 474
256 280938
257 60545
258 39801
259 30726
260 55678
261 18459
262 12838
263 2643
264 5276
265 1180
266 66065
267 1844
268 3255
269 7089
270 3277
271 465
272 210
273 130165
274 1269
275 51349
276 63608
277 23145
278 4007
279 2425
280 3013
281 41460
282 51581
283 121678
284 15077
285 10986
286 8010
287 44646
288 2281
289 1501
290 2973
291 16998
292 4830
293 81735
294 16112
295 14230
296 32909
297 19832
298 20611
299 3981
300 2615
"""

data_list = [line.split() for line in data_text.strip().split('\n')]
df = pd.DataFrame(data_list, columns=['Index', 'Value'])
df['Value'] = df['Value'].astype(float)

# Построение гистограммы
plt.figure(figsize=(14,6))
counts, bins, patches = plt.hist(df['Value'], bins=50, color='skyblue', edgecolor='black')

# Подписи осей
plt.title("Гистограмма распределения частот значений")
plt.xlabel("Интервал значений")
plt.ylabel("Частота (кол-во)")

plt.yscale("log")
plt.grid(True, axis='y', linestyle='--', alpha=0.7)

# Подписи на X по центру каждого бина
bin_centers = 0.5 * (bins[:-1] + bins[1:])
bin_labels = [f"{int(bins[i])}-{int(bins[i+1])}" for i in range(len(bins)-1)]
plt.xticks(bin_centers[::2], bin_labels[::2], rotation=45)  # подписи через один

plt.tight_layout()
plt.show()

data_list = [line.split() for line in data_text.strip().split('\n')]
df = pd.DataFrame(data_list, columns=['Index', 'Value'])
df['Value'] = df['Value'].astype(float)

# Задаём количество интервалов
num_bins = 20
counts, bins = np.histogram(df['Value'], bins=num_bins)

# Формируем строки таблицы
left_edges = [round(b, 3) for b in bins[:-1]]
right_edges = [round(b, 3) for b in bins[1:]]
frequencies = counts

# Создаём DataFrame, где колонки — номера интервалов
table = pd.DataFrame([left_edges, right_edges, frequencies],
                     index=['Левая граница', 'Правая граница', 'Частота'],
                     columns=[str(i+1) for i in range(num_bins)])

# Красивый вывод
print(table.to_string())